<div class="max-w-4xl mx-auto">
  <!-- Page Header -->
  <div class="page-header">
    <div class="flex items-center space-x-2 mb-2">
      <a routerLink="/" class="text-secondary-500 hover:text-secondary-700 text-sm">Home</a>
      <span class="text-secondary-400">/</span>
      <a routerLink="/convert" class="text-secondary-500 hover:text-secondary-700 text-sm">Convert</a>
      <span class="text-secondary-400">/</span>
      <span class="text-secondary-900 font-medium text-sm">PDF to Word</span>
    </div>
    <h1 class="page-title">PDF to Word Converter</h1>
    <p class="page-subtitle">Convert PDF documents to editable Microsoft Word format</p>
  </div>

  <div class="space-y-6">
    <!-- Step 1: Upload -->
    <div class="card">
      <div class="card-header flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
            <span class="text-blue-600 font-bold text-sm">1</span>
          </div>
          <h3 class="font-semibold text-secondary-900">Upload PDF Document</h3>
        </div>
        <span class="badge bg-secondary-100 text-secondary-600">Required</span>
      </div>
      <div class="card-body">
        <nz-upload
          nzType="drag"
          [nzMultiple]="false"
          [nzBeforeUpload]="beforeUpload"
          [(nzFileList)]="fileList"
          class="upload-zone"
          [class.dragover]="false">
          <p class="ant-upload-drag-icon">
            <i nz-icon nzType="file-pdf" nzTheme="outline" class="text-5xl text-red-500"></i>
          </p>
          <p class="ant-upload-text text-lg font-medium text-secondary-700 mb-2">
            Drag & Drop PDF Files Here
          </p>
          <p class="ant-upload-hint text-secondary-500">
            or click to browse • Supports: .pdf
          </p>
        </nz-upload>

        <!-- Selected File -->
        <div *ngIf="fileList.length > 0" class="mt-4 p-4 bg-red-50 rounded-lg border border-red-200">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <i nz-icon nzType="file-pdf" nzTheme="outline" class="text-2xl text-red-600"></i>
              <div>
                <p class="font-medium text-secondary-900">{{ fileList[0].name }}</p>
                <p class="text-sm text-secondary-500">
                  {{ formatFileSize(fileList[0].size || 0) }}
                </p>
              </div>
            </div>
            <button 
              (click)="fileList = []"
              class="btn-icon text-secondary-400 hover:text-danger-600">
              <i nz-icon nzType="close" nzTheme="outline"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Step 2: Options -->
    <div class="card" *ngIf="fileList.length > 0">
      <div class="card-header flex items-center space-x-3">
        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
          <span class="text-blue-600 font-bold text-sm">2</span>
        </div>
        <h3 class="font-semibold text-secondary-900">Conversion Options</h3>
      </div>
      <div class="card-body">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Output Format -->
          <div>
            <label class="form-label">Output Format</label>
            <nz-select [(ngModel)]="options.outputFormat" class="w-full">
              <nz-option nzValue="docx" nzLabel="DOCX (Word 2007+)"></nz-option>
              <nz-option nzValue="doc" nzLabel="DOC (Word 97-2003)"></nz-option>
            </nz-select>
          </div>

          <!-- OCR Language -->
          <div *ngIf="options.useOcr">
            <label class="form-label">OCR Language</label>
            <nz-select [(ngModel)]="options.ocrLanguage" class="w-full">
              <nz-option 
                *ngFor="let lang of ocrLanguages" 
                [nzValue]="lang.value" 
                [nzLabel]="lang.label">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <!-- Checkboxes -->
        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
          <label nz-checkbox [(ngModel)]="options.preserveLayout">
            <span class="text-secondary-700">Preserve original layout</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.extractImages">
            <span class="text-secondary-700">Extract images</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.useOcr">
            <span class="text-secondary-700">Use OCR for scanned PDFs</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.includeHeadersFooters">
            <span class="text-secondary-700">Include headers & footers</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.preserveHyperlinks">
            <span class="text-secondary-700">Preserve hyperlinks</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Step 3: Convert -->
    <div class="card" *ngIf="fileList.length > 0 && !converted">
      <div class="card-header flex items-center space-x-3">
        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
          <span class="text-blue-600 font-bold text-sm">3</span>
        </div>
        <h3 class="font-semibold text-secondary-900">Convert</h3>
      </div>
      <div class="card-body">
        <div class="text-center py-6">
          <button 
            (click)="onConvert()"
            [disabled]="converting"
            class="btn-primary text-lg px-8 py-3">
            <i nz-icon nzType="swap" nzTheme="outline" class="mr-2"></i>
            <span *ngIf="!converting">Convert to Word</span>
            <span *ngIf="converting">Converting...</span>
          </button>
        </div>

        <!-- Progress -->
        <div *ngIf="converting" class="mt-4">
          <nz-progress 
            [nzPercent]="conversionProgress" 
            [nzStatus]="conversionProgress < 100 ? 'active' : 'success'"
            nzStrokeWidth="8">
          </nz-progress>
          <p class="text-center text-sm text-secondary-500 mt-2">
            {{ conversionProgress < 30 ? 'Analyzing document...' : 
               conversionProgress < 60 ? 'Extracting text and images...' : 
               conversionProgress < 90 ? 'Reconstructing document...' : 
               'Finalizing...' }}
          </p>
        </div>
      </div>
    </div>

    <!-- Step 4: Preview & Download -->
    <div class="card" *ngIf="converted && convertedFile">
      <div class="card-header flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-success-100 rounded-lg flex items-center justify-center">
            <i nz-icon nzType="check" nzTheme="outline" class="text-success-600"></i>
          </div>
          <h3 class="font-semibold text-secondary-900">Conversion Complete</h3>
        </div>
        <button 
          (click)="showPreview = !showPreview"
          class="btn-secondary text-sm">
          <i nz-icon nzType="eye" nzTheme="outline" class="mr-2"></i>
          {{ showPreview ? 'Hide' : 'Show' }} Preview
        </button>
      </div>
      <div class="card-body">
        <!-- File Info -->
        <div class="p-4 bg-success-50 rounded-lg border border-success-200 mb-6">
          <div class="flex items-center space-x-3">
            <i nz-icon nzType="file-word" nzTheme="outline" class="text-3xl text-blue-500"></i>
            <div class="flex-1">
              <p class="font-medium text-secondary-900">{{ convertedFile.name }}</p>
              <p class="text-sm text-secondary-500">
                {{ formatFileSize(convertedFile.size) }} • {{ convertedFile.pages }} pages
              </p>
            </div>
          </div>
        </div>

        <!-- Text Preview -->
        <div *ngIf="showPreview" class="mb-6">
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-medium text-secondary-900">Extracted Text Preview</h4>
            <button 
              (click)="copyToClipboard()"
              class="btn-secondary text-sm">
              <i nz-icon nzType="copy" nzTheme="outline" class="mr-2"></i>
              Copy Text
            </button>
          </div>
          <div class="bg-secondary-50 border border-secondary-200 rounded-lg p-4 max-h-64 overflow-y-auto">
            <pre class="text-sm text-secondary-700 whitespace-pre-wrap font-sans">{{ extractedText }}</pre>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex flex-col sm:flex-row gap-3">
          <button (click)="onDownload()" class="btn-primary flex-1">
            <i nz-icon nzType="download" nzTheme="outline" class="mr-2"></i>
            Download Word Document
          </button>
          <button (click)="onReset()" class="btn-secondary flex-1">
            <i nz-icon nzType="reload" nzTheme="outline" class="mr-2"></i>
            Convert Another
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
