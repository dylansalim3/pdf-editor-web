<div class="max-w-4xl mx-auto">
  <!-- Page Header -->
  <div class="page-header">
    <div class="flex items-center space-x-2 mb-2">
      <a routerLink="/" class="text-secondary-500 hover:text-secondary-700 text-sm">Home</a>
      <span class="text-secondary-400">/</span>
      <a routerLink="/convert" class="text-secondary-500 hover:text-secondary-700 text-sm">Convert</a>
      <span class="text-secondary-400">/</span>
      <span class="text-secondary-900 font-medium text-sm">Word to PDF</span>
    </div>
    <h1 class="page-title">Word to PDF Converter</h1>
    <p class="page-subtitle">Convert Microsoft Word documents to PDF format while preserving formatting</p>
  </div>

  <div class="space-y-6">
    <!-- Step 1: Upload -->
    <div class="card">
      <div class="card-header flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
            <span class="text-blue-600 font-bold text-sm">1</span>
          </div>
          <h3 class="font-semibold text-secondary-900">Upload Word Document</h3>
        </div>
        <span class="badge bg-secondary-100 text-secondary-600">Required</span>
      </div>
      <div class="card-body">
        <nz-upload
          nzType="drag"
          [nzMultiple]="false"
          [nzBeforeUpload]="beforeUpload"
          [(nzFileList)]="fileList"
          class="upload-zone"
          [class.dragover]="false">
          <p class="ant-upload-drag-icon">
            <i nz-icon nzType="file-word" nzTheme="outline" class="text-5xl text-blue-500"></i>
          </p>
          <p class="ant-upload-text text-lg font-medium text-secondary-700 mb-2">
            Drag & Drop Word Files Here
          </p>
          <p class="ant-upload-hint text-secondary-500">
            or click to browse • Supports: .doc, .docx
          </p>
        </nz-upload>

        <!-- Selected File -->
        <div *ngIf="fileList.length > 0" class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <i nz-icon nzType="file-word" nzTheme="outline" class="text-2xl text-blue-600"></i>
              <div>
                <p class="font-medium text-secondary-900">{{ fileList[0].name }}</p>
                <p class="text-sm text-secondary-500">
                  {{ formatFileSize(fileList[0].size || 0) }}
                </p>
              </div>
            </div>
            <button 
              (click)="fileList = []"
              class="btn-icon text-secondary-400 hover:text-danger-600">
              <i nz-icon nzType="close" nzTheme="outline"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Step 2: Options -->
    <div class="card" *ngIf="fileList.length > 0">
      <div class="card-header flex items-center space-x-3">
        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
          <span class="text-blue-600 font-bold text-sm">2</span>
        </div>
        <h3 class="font-semibold text-secondary-900">Conversion Options</h3>
      </div>
      <div class="card-body">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Page Setup -->
          <div>
            <label class="form-label">Page Size</label>
            <nz-select [(ngModel)]="options.pageSize" class="w-full">
              <nz-option nzValue="A4" nzLabel="A4"></nz-option>
              <nz-option nzValue="Letter" nzLabel="Letter (US)"></nz-option>
              <nz-option nzValue="Legal" nzLabel="Legal"></nz-option>
            </nz-select>
          </div>

          <!-- Orientation -->
          <div>
            <label class="form-label">Orientation</label>
            <nz-select [(ngModel)]="options.orientation" class="w-full">
              <nz-option nzValue="portrait" nzLabel="Portrait"></nz-option>
              <nz-option nzValue="landscape" nzLabel="Landscape"></nz-option>
            </nz-select>
          </div>

          <!-- Image Quality -->
          <div>
            <label class="form-label">Image Quality</label>
            <nz-select [(ngModel)]="options.imageQuality" class="w-full">
              <nz-option nzValue="high" nzLabel="High (Best Quality)"></nz-option>
              <nz-option nzValue="medium" nzLabel="Medium (Balanced)"></nz-option>
              <nz-option nzValue="low" nzLabel="Low (Smallest Size)"></nz-option>
            </nz-select>
          </div>
        </div>

        <!-- Checkboxes -->
        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
          <label nz-checkbox [(ngModel)]="options.embedFonts">
            <span class="text-secondary-700">Embed fonts for better compatibility</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.preserveLinks">
            <span class="text-secondary-700">Preserve hyperlinks</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.preserveComments">
            <span class="text-secondary-700">Preserve comments and annotations</span>
          </label>
          <label nz-checkbox [(ngModel)]="options.minimizeSize">
            <span class="text-secondary-700">Minimize file size</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Step 3: Convert -->
    <div class="card" *ngIf="fileList.length > 0 && !converted">
      <div class="card-header flex items-center space-x-3">
        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
          <span class="text-blue-600 font-bold text-sm">3</span>
        </div>
        <h3 class="font-semibold text-secondary-900">Convert</h3>
      </div>
      <div class="card-body">
        <div class="text-center py-6">
          <button 
            (click)="onConvert()"
            [disabled]="converting"
            class="btn-primary text-lg px-8 py-3">
            <i nz-icon nzType="swap" nzTheme="outline" class="mr-2"></i>
            <span *ngIf="!converting">Convert to PDF</span>
            <span *ngIf="converting">Converting...</span>
          </button>
        </div>

        <!-- Progress -->
        <div *ngIf="converting" class="mt-4">
          <nz-progress 
            [nzPercent]="conversionProgress" 
            [nzStatus]="conversionProgress < 100 ? 'active' : 'success'"
            nzStrokeWidth="8">
          </nz-progress>
          <p class="text-center text-sm text-secondary-500 mt-2">
            Converting document... {{ conversionProgress }}%
          </p>
        </div>
      </div>
    </div>

    <!-- Step 4: Download -->
    <div class="card" *ngIf="converted && convertedFile">
      <div class="card-header flex items-center space-x-3">
        <div class="w-8 h-8 bg-success-100 rounded-lg flex items-center justify-center">
          <i nz-icon nzType="check" nzTheme="outline" class="text-success-600"></i>
        </div>
        <h3 class="font-semibold text-secondary-900">Conversion Complete</h3>
      </div>
      <div class="card-body">
        <div class="p-4 bg-success-50 rounded-lg border border-success-200 mb-6">
          <div class="flex items-center space-x-3">
            <i nz-icon nzType="file-pdf" nzTheme="outline" class="text-3xl text-red-500"></i>
            <div class="flex-1">
              <p class="font-medium text-secondary-900">{{ convertedFile.name }}</p>
              <p class="text-sm text-secondary-500">
                {{ formatFileSize(convertedFile.size) }} • {{ convertedFile.pages }} pages
              </p>
            </div>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-3">
          <button (click)="onDownload()" class="btn-primary flex-1">
            <i nz-icon nzType="download" nzTheme="outline" class="mr-2"></i>
            Download PDF
          </button>
          <a routerLink="/tools/watermark" class="btn-secondary flex-1 text-center">
            <i nz-icon nzType="edit" nzTheme="outline" class="mr-2"></i>
            Edit PDF
          </a>
          <button (click)="onReset()" class="btn-secondary flex-1">
            <i nz-icon nzType="reload" nzTheme="outline" class="mr-2"></i>
            Convert Another
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
